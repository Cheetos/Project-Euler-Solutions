\addcontentsline{toc}{chapter}{516 - 5-smooth totients}
\chapter*{516 - 5-smooth totients}

5-smooth numbers are numbers whose largest prime factor doesn't exceed 5.
5-smooth numbers are also called Hamming numbers.
Let $S(L)$ be the sum of the numbers n not exceeding $L$ such that Euler's totient function $\phi(n)$ is a Hamming number.\\

$S(100)=3728.$\\

Find $S(10^{12})$. Give your answer modulo $2^{32}$.

\section*{Solution}

To solve this problem we do the following:

\begin{itemize}
    \item Store all numbers of the form $2^a 3^b 5^c$ in an array $H$.
    \item Obtain all prime numbers of the form $2^a 3^b 5^c + 1$ greater than 5 and store them in an array $T$. Since a prime number $p$ has $\phi(p) = p-1$, then all elements in $T$ comply with $\phi(2^a 3^b 5^c + 1) = 2^a 3^b 5^c$.
    \item Sort the elements in $H$ and $T$.
    \item Add the sum of all elements in $H$ to the answer.
    \item Multiply each element in $H$ to all combinations of products of the elements in $T$ and add those values to the answer. Since the $\phi$ function is multiplicative , then for a any prime $p$ in $T$ we have 
    
    \begin{align*}
        \phi(p 2^a 3^b 5^c) &= \phi(p) \phi(2^a) \phi(3^b) \phi(5^c) \\
        &= (2^x 3^y 5^z) (2^{a-1}) (3^{b-1}) (5^{c-1}) \\
        &= 2^{x+a-1} 3^{y+b-1} 5^{z+c-1}
    \end{align*}
    
    To this last part we can use backtracking, just be careful to not multiply the same prime more than once, since $\phi(nm) = \phi(n)\phi(m)$ only if $gcd(n,m) = 1$.
    
\end{itemize}

